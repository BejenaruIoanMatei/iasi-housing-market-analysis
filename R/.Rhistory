library(dplyr)
library(Hmisc)
library(tidyr)
library(stringr)
library(readxl)
df <- read.csv('../data/processed/2_clean_data.csv')
df <- read.csv('../data/processed/2_clean_data.csv')
head(df, n = 5)
names(df)
glimpse(df)
dim(df)
drops <- c("X", "Compartimentare")
df <- df[,!(names(df) %in% drops )]
dim(df)
glimpse(df)
library(dplyr)
for (i in names(df)) {
if (is.factor(df[[i]])) {
print(levels(df[[i]])) }
}
df$Zona <- as.factor(df$Zona)
df$Vechime_Imobil <- as.factor(df$Vechime_Imobil)
df$Tip_Zona <- as.factor(df$Tip_Zona)
str(df)
glimpse(df)
summary(df)
summary(df$Pret)
summary(df$Suprafata_Utila)
summary(df$Camere)
hist(date_iasi$Pret, breaks=30, main="Distributia Preturilor", col="skyblue")
hist(df$Pret, breaks=30, main="Distributia Preturilor", col="skyblue")
boxplot(df$Pret, main="Identificare Outlieri Pret")
hist(df$Pret, breaks=20, main="Distributia Preturilor", col="skyblue")
boxplot(df$Pret, main="Identificare Outlieri Pret")
hist(df$Pret, breaks=20, main="Distributia Preturilor", col="skyblue")
mean(df$Pret)
median(df$Pret)
hist(log(df$Pret))
boxplot(df$Pret, main = "Identificare outlieri Pret")
boxplot(df$Pret, main = "Identificare outlieri Pret", horizontal = T)
boxplot(df$Pret_mp, main = "Identificare outlieri Pret_mp", horizontal = T)
boxplot(df$Camere, main = "Identificare outlieri Camere", horizontal = T)
boxplot(df$Suprafata_Utila, main = "Identificare outlieri Suprafata_Utila", horizontal = T)
hist(df$Camere, breaks = 20, main="Distributia numarului de camere")
hist(df$Camere, breaks = 3, main="Distributia numarului de camere")
hist(df$Camere, breaks = 2, main="Distributia numarului de camere")
hist(df$Camere, breaks = 4, main="Distributia numarului de camere")
hist(df$Camere, breaks = 5, main="Distributia numarului de camere")
hist(df$Camere, breaks = 10, main="Distributia numarului de camere")
table(df$Camere)
prop.table(table(df$Camere))
tab_zona <- table(df$Tip_Zona)
barplot(tab_zona, main="Distributia ofertelor pe Tip de Zona",
col="orange", las=2, cex.names=0.8)
tab_zona <- table(df$Tip_Zona)
barplot(tab_zona, main="Distributia ofertelor pe Tip de Zona")
tab_zona <- table(df$Tip_Zona)
barplot(tab_zona, main="Distributia ofertelor pe Tip de Zona", las=2)
tab_zona <- table(df$Tip_Zona)
barplot(tab_zona, main="Distributia ofertelor pe Tip de Zona", las=2, height = 500)
tab_zona <- table(df$Tip_Zona)
barplot(tab_zona, main="Distributia ofertelor pe Tip de Zona", las=2
tab_zona <- table(df$Tip_Zona)
barplot(tab_zona, main="Distributia ofertelor pe Tip de Zona", las=2)
tab_zona <- table(df$Tip_Zona)
barplot(tab_zona, main="Distributia ofertelor pe Tip de Zona", las=1)
tab_zona <- table(df$Tip_Zona)
barplot(tab_zona, main="Distributia ofertelor pe Tip de Zona", las=3)
tab_zona <- table(df$Tip_Zona)
barplot(tab_zona, main="Distributia ofertelor pe Tip de Zona", las=2)
prop.table(table(df$Vechime_Imobil))
tab_zona <- table(df$Zona)
barplot(tab_zona, main="Distributia ofertelor pe Tip de Zona", las=2)
regresie_simpla <- lm(Pret ~ Suprafata_Utila, data = df)
summary(model)
summary(regresie_simpla)
shapiro.test(residuals(regresie_simpla))
library(lmtest)
install.packages("lmtest")
library(lmtest)
bptest(regresie_simpla)
plot(regresie_simpla$fitted.values, residuals(regresie_simpla),
xlab = "Valori estimate",
ylab = "Reziduuri")
abline(h = 0, col = "red")
plot(cooks.distance(regresie_simpla), type = "h")
abline(h = 4/nrow(df), col = "red")
par(mfrow = c(2, 2))
plot(regresie_simpla)
# Calculăm distanța Cook
cooks_d <- cooks.distance(regresie_simpla)
# Grafic pentru vizualizarea punctelor
plot(cooks_d, type = "h", main = "Distanta Cook pentru Modelul Simplu",
ylab = "Distanta Cook", xlab = "Indice Observatie")
abline(h = 4/nrow(df), col = "red", lty = 2) # Pragul critic 4/n
cooks_d <- cooks.distance(regresie_simpla)
plot(cooks_d, type = "h", main = "Distanta Cook pentru Modelul Simplu",
ylab = "Distanta Cook", xlab = "Indice Observatie")
abline(h = 4/nrow(df), col = "red", lty = 2)
plot(regresie_simpla)
regresie_multipla <- lm(Pret ~ Suprafata_Utila + Camere + Tip_Zona, data = df)
summary(regresie_multipla)
shapiro.test(residuals(regresie_multipla))
plot(regresie_multipla$fitted.values, residuals(regresie_multipla),
xlab = "Valori estimate",
ylab = "Reziduuri")
abline(h = 0, col = "red")
cooks_d <- cooks.distance(regresie_multipla)
plot(cooks_d, type = "h", main = "Distanta Cook pentru Modelul Multiplu",
ylab = "Distanta Cook", xlab = "Indice Observatie")
abline(h = 4/nrow(df), col = "red", lty = 2)
plot(regresie_multipla)
df %>%
select(Pret)
df %>%
select(Pret) %>%
head(n = 5)
glimpse(df)
var_numerice <- df %>% select(Pret, Suprafata_Utila, Camere, Pret_mp)
head(var_numerice, n = 5)
glimpse(df)
var_numerice <- df %>% select(Pret, Suprafata_Utila, Camere)
head(var_numerice, n = 5)
cor(var_numerice)
install.packages("corrplot")
library(corrplot)
corrplot(cor_matrix, method = "circle", type = "upper",
tl.col = "black", tl.srt = 45,
addCoef.col = "black", number.cex = 0.8,
title = "Matricea de Corelatie - Variabile Numerice",
mar = c(0,0,2,0))
corrplot(var_numerice, method = "circle", type = "upper",
tl.col = "black", tl.srt = 45,
addCoef.col = "black", number.cex = 0.8,
title = "Matricea de Corelatie - Variabile Numerice",
mar = c(0,0,2,0))
corrplot(cor(var_numerice), method = "circle", type = "upper",
tl.col = "black", tl.srt = 45,
addCoef.col = "black", number.cex = 0.8,
title = "Matricea de Corelatie - Variabile Numerice",
mar = c(0,0,2,0))
corrplot(cor(var_numerice), method = "circle", type = "upper",
tl.col = "white", tl.srt = 45,
addCoef.col = "black", number.cex = 0.8,
title = "Matricea de Corelatie - Variabile Numerice",
mar = c(0,0,2,0))
corrplot(cor(var_numerice), method = "circle", type = "upper",
tl.col = "black", tl.srt = 45,
addCoef.col = "black", number.cex = 0.8,
title = "Matricea de Corelatie - Variabile Numerice",
mar = c(0,0,2,0))
corrplot(cor(var_numerice), method = "circle", type = "upper",
tl.col = "black", tl.srt = 45,
addCoef.col = "white", number.cex = 0.8,
title = "Matricea de Corelatie - Variabile Numerice",
mar = c(0,0,2,0))
corrplot(cor(var_numerice), method = "circle", type = "upper",
tl.col = "black", tl.srt = 45,
addCoef.col = "white", number.cex = 0.5,
title = "Matricea de Corelatie - Variabile Numerice",
mar = c(0,0,2,0))
corrplot(cor(var_numerice), method = "circle", type = "upper",
tl.col = "black", tl.srt = 45,
addCoef.col = "white", number.cex = 0.7,
title = "Matricea de Corelatie - Variabile Numerice",
mar = c(0,0,2,0))
corrplot(cor(var_numerice), method = "circle", type = "upper",
tl.col = "black", tl.srt = 45,
addCoef.col = "white", number.cex = 0.7,
title = "Matricea de Corelatie - Variabile Numerice")
corrplot(cor(var_numerice), method = "circle", type = "upper",
tl.col = "black", tl.srt = 45,
addCoef.col = "white", number.cex = 0.7,
title = "Matricea de Corelatie - Variabile Numerice",
mar = c(0,0,2,0))
plot(df$Suprafata_Utila, df$Pret,
xlab = "Suprafata Utila (mp)",
ylab = "Pret (euro)",
main = "Relatia dintre Suprafata si Pret",
pch = 19,
col = "steelblue")
abline(lm(Pret ~ Suprafata_Utila), data = df, col = "red", lwd = 2)
plot(df$Suprafata_Utila, df$Pret,
xlab = "Suprafata Utila (mp)",
ylab = "Pret (EUR)",
main = "Relatia dintre Suprafata si Pret",
pch = 19, col = "steelblue")
abline(lm(Pret ~ Suprafata_Utila, data = df), col = "red", lwd = 2)
cor.test(df$Pret, df$Suprafata_Utila)
cor.test(df$Pret, df$Camere)
cor.test(df$Suprafata_Utila, df$Camere)
# Tabel comparativ modele
data.frame(
Model = c("Simplu", "Multiplu"),
R_squared = c(0.7404, 0.7642),
Adj_R_squared = c(0.7399, 0.7619),
F_statistic = c(1477, 333.2),
Variabile = c("Suprafata_Utila", "Suprafata_Utila + Camere + Tip_Zona")
)
data.frame(
Model = c("Simplu", "Multiplu"),
R_squared = c(0.7404, 0.7642),
Adj_R_squared = c(0.7399, 0.7619),
F_statistic = c(1477, 333.2),
Variabile = c("Suprafata_Utila", "Suprafata_Utila + Camere + Tip_Zona")
)
# Selectarea variabilelor numerice
num_cols <- c("Pret", "Suprafata_Utila", "Camere", "Pret_mp")
# Matricea de corelatie Pearson
corr_matrix <- cor(df[, num_cols], use = "complete.obs", method = "pearson")
corrplot(corr_matrix,
method = "color",
type = "upper",
addCoef.col = "black",
number.cex = 0.8,
tl.col = "black",
tl.srt = 45,
col = colorRampPalette(c("blue", "white", "red"))(200),
title = "Matricea de corelatie Pearson",
mar = c(0, 0, 2, 0))
accesibil <- df[df$Tip_Zona == "Accesibil/Rezidential", ]
corr_matrix <- cor(accesibil[, num_cols],use = "complete.obs")
corrplot(corr_matrix,
method = "color",
type = "upper",
addCoef.col = "black",
number.cex = 0.8,
tl.col = "black",
tl.srt = 45,
col = colorRampPalette(c("blue", "white", "red"))(200),
title = "Matricea de corelatie Pearson – Zona Accesibil/Rezidential",
mar = c(0, 0, 2, 0))
num_cols <- c("Pret", "Suprafata_Utila", "Camere", "Pret_mp")
corr_matrix <- cor(df[, num_cols])
corrplot(corr_matrix,
method = "color",
type = "upper",
addCoef.col = "black",
number.cex = 0.8,
tl.col = "black",
tl.srt = 45,
col = colorRampPalette(c("blue", "white", "red"))(200),
title = "Matricea de corelatie Pearson",
mar = c(0, 0, 2, 0))
accesibil <- df[df$Tip_Zona == "Accesibil/Rezidential", ]
corr_matrix <- cor(accesibil[, num_cols])
corrplot(corr_matrix,
method = "color",
type = "upper",
addCoef.col = "black",
number.cex = 0.8,
tl.col = "black",
tl.srt = 45,
col = colorRampPalette(c("blue", "white", "red"))(200),
title = "Matricea de corelatie Pearson – Zona Accesibil/Rezidential",
mar = c(0, 0, 2, 0))
table(df$Vechime_Imobil)
pret_noi <- df[df$Vechime_Imobil == "Nou (Post-2000)",]$Pret_mp
pret_noi
pret_noi <- df[df$Vechime_Imobil == "Nou (Post-2000)",]$Pret_mp
len(pret_noi)
size(pret_noi)
dim(pret_noi)
class(pret_noi)
pret_noi <- df[df$Vechime_Imobil == "Nou (Post-2000)",]$Pret_mp
pret_noi
pret_noi <- df$Pret_mp[df$Vechime_Imobil == "Nou (Post-2000)"]
pret_vechi <- df$Pret_mp[df$Vechime_Imobil == "Vechi (Pre-1977)"]
class(pret_noi)
length(pret_noi)
length(pret_vechi)
leveneTest(c(pret_noi, pret_vechi),
group = factor(c(rep("Nou", length(pret_noi)),
rep("Vechi", length(pret_vechi)))))
install.packages("car")
library(car)
leveneTest(c(pret_noi, pret_vechi),
group = factor(c(rep("Nou", length(pret_noi)),
rep("Vechi", length(pret_vechi)))))
leveneTest(list(pret_noi, pret_vechi))
leveneTest(Pret_mp ~ Vechime_Imobil,
data = df,
subset = Vechime_Imobil %in% c("Nou (Post-2000)", "Vechi (Pre-1977)"))
t.test(Pret_mp ~ Vechime_Imobil,
data = df,
subset = Vechime_Imobil %in% c("Nou (Post-2000)", "Vechi (Pre-1977)"),
var.equal = F)
t.test(df$Pret_mp)$conf.int
chisq.test(df$Zona, df$Vechime_Imobil)
chisq.test(df$Tip_Zona, df$Vechime_Imobil)
